<section id="welcome-section" class="wb-frmvld">
<form id="welcome-form" class="form-horizontal" method="post">

## {{ page.welcome.heading }}

{{ page.welcome.intro1 }}

{{ page.welcome.intro2 }}

{{ page.welcome.intro3 }}

<section>

<!-- markdownlint-disable MD026 -->

### {{ page.welcome.menu.heading }}

<!-- markdownlint-enable MD026 -->

<div class="btn-group" markdown="0">
<!-- Resume a current assessment (only visible if assessment data is detected) -->
<button id="resume-assessment" type="button" disabled="disabled" class="btn btn-default wb-format-gen" data-wb-format-gen='{ "eventTrigger": "click", "eventElement": "#resume-assessment", "operations": [
  { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": "restore-domain" },
  { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": "default-domain-buttons" },
  { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": "show-domain" }
] }'>{{ page.common.resumeAssessment }}</button>
<!-- Starts a new assessment -->
<button id="start-assessment" type="button" class="btn btn-default wb-format-gen wb-calculate" data-wb-format-gen='{ "eventTrigger": "click", "eventElement": "#start-assessment", "operations": [
  { "resetForm": "#domain-form, #activity-form, #component-form, #confidentiality-form, #integrity-form, #availability-form" },
  { "type": "sessionStorage", "key": "assessment", "action": "delete" },
  { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-domain" ], "action": "replace", "source": -1 },
  { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": "default-domain-buttons" },
  { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": "show-domain" }
] }' data-wb-calculate='{ "ignoreInit": true, "eventTrigger": "click", "eventElement": "#start-assessment", "operations": [
  { "type": "action",
    "inputs": [
      { "type": "outputValue", "outputTarget": "#resume-assessment", "outputProperty": "disabled", "value": true }
    ]
  }
] }'>{{ page.common.startAssessment }}</button>
<!-- Button for restoring progress from a JSON file. This button triggers the hidden input type="file" field. This is done to give more visual control over the appearance than what the input type="file" field allows. Afterwards it showsthe business domain section. -->
<button id="restore-from-file-button-welcome" type="button" class="btn btn-default wb-format-gen" data-wb-format-gen='{ "eventTrigger": "click", "eventElement": "#restore-from-file-button-welcome", "operations": [
  { "type": "event", "outputTarget": "#restore-from-file", "outputEvent": "click" }
] }'>{{ site.RestoreFromFile[ page.lang ] }}</button>
</div>

</section>

</form>
</section>

<section id="domain-section" class="hidden wb-frmvld">
<form id="domain-form" class="form-horizontal" method="post">

## {{ page.domain.title }}

{{ page.domain.intro }}

<div id="domain-fields-container" class="wb-calculate wb-format-gen" data-wb-calculate='{ "ignoreInit": true, "eventTrigger": "input", "eventElement": "#domain-fields-container", "operations": [
  { "type": "conditional",
    "inputs": [
      { "type": "==",
        "inputs": [
          { "type": "boolean", "query": "#save-domain", "sourceProperty": "disabled" },
          true
        ]
      }
    ],
    "actionsTrue": [
      { "type": "outputValue", "outputTarget": "#save-domain, #cancel-domain", "outputProperty": "disabled", "value": false },
      { "type": "conditional",
        "inputs": [
          { "type": "==",
            "inputs": [
              { "type": "boolean", "query": "#delete-domain", "sourceProperty": "disabled" },
              false
            ]
          },
          { "type": "==",
            "inputs": [
              { "type": "string", "query": "#sec-cat-form-properties", "sourceAttribute": "data-sec-cat-form-state", "indexesKeys": [ "current-action" ] },
              "append"
            ]
          }
        ],
        "actionsTrue": [
          { "type": "event", "outputTarget": "#domain-fields-container", "outputEvent": "edit-domain" }
        ]
      },
      { "type": "outputValue", "outputTarget": "#delete-domain, #add-another-domain, #add-activity", "outputProperty": "disabled", "value": true }
    ]
  }
] }' data-wb-format-gen='[
  { "eventTrigger": "edit-domain", "eventElement": "#domain-fields-container", "operations": [
    { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-action" ], "action": "replace", "data": "replace" },
    { "type": "dataAttribute", "element": "#save-domain", "key": "data-wb-format-gen", "indexesKeys": [ 0, "operations", 0, "indexesKeys", 0 ], "action": "replace", "data": { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-domain" ] } }
  ] },
  { "eventTrigger": "append-domain", "eventElement": "#domain-fields-container", "operations": [
    { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-action" ], "action": "replace", "data": "append" },
    { "type": "dataAttribute", "element": "#save-domain", "key": "data-wb-format-gen", "indexesKeys": [ 0, "operations", 0, "indexesKeys" ], "action": "delete" }
  ] }
]'>

<div class="form-group" markdown="0">
<label for="domain-field" class="required {{ page.labelGridClass }}"><span class="field-name">{{ page.domain[ "domain-field-label" ] }}</span> <strong class="required">({{ site.required[ page.lang ] }})</strong></label>
<div class="{{ page.fieldGridClass }}">
<input name="domain-field" id="domain-field" type="text" required="required" pattern=".{2,}" data-rule-minlength="2" />
</div>
</div>

</div>

<div class="btn-group" markdown="0">
<!-- Save to memory, update buttons across forms, enables/disables buttons in the current form, and (TODO) shows an indicator that the save was successful -->
<button id="save-domain" type="submit" disabled="disabled" class="btn btn-primary wb-calculate wb-format-gen" data-wb-calculate='[
  { "ignoreInit": true, "eventTrigger": "submit", "eventElement": "#domain-form", "listenerElement": "body", "returnFalse": true, "operations": [
    { "type": "action",
      "inputs": [
        { "type": "event", "outputTarget": "#save-domain", "outputEvent": "save-domain-proceed" }
      ]
    }
  ] },
  { "ignoreInit": true, "eventTrigger": "save-domain-complete", "eventElement": "#save-domain", "operations": [
      { "type": "conditional",
        "inputs": [
          { "type": "==",
            "inputs": [
              { "type": "string", "query": "#sec-cat-form-properties", "sourceAttribute": "data-sec-cat-form-state", "indexesKeys": [ "current-action" ] },
              "append"
            ]
          }
        ],
        "actionsTrue": [
          { "type": "event", "outputTarget": "#save-domain", "outputEvent": "last-domain" }
        ],
        "actionsFalse": [
          { "type": "event", "outputTarget": "#domain-fields-container", "outputEvent": "append-domain" }
        ]
      },
      {
        "type": "action",
        "inputs": [
          { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": "default-domain-buttons" }
        ]
      }
  ] }
]' data-wb-format-gen='[
  { "eventTrigger": "save-domain-proceed", "eventElement": "#save-domain", "operations": [
    { "type": "sessionStorage", "key": "assessment", "source": "form-state", "container": "#domain-form",
      "action": { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-action" ] }
    },
    { "type": "event", "outputTarget": "#save-domain", "outputEvent": "save-domain-complete" }
  ] },
  { "eventTrigger": "last-domain", "eventElement": "#save-domain", "operations": [
    { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-domain" ], "action": "replace", "source": { "type": "sessionStorage", "key": "assessment", "action": "lastIndex" } }
  ] }
]'>{{ page.common.save }}</button>
<!-- Loads the previous domain in the current form or clear the forms where a previous domain does not exist. Also enables/disables buttons in the current form. -->
<button id="cancel-domain" type="button" disabled="disabled" class="btn btn-default wb-calculate" data-wb-calculate='{ "ignoreInit": true, "eventTrigger": "click", "eventElement": "#cancel-domain", "operations": [
  { "type": "conditional",
    "inputs": [
      { "type": "==",
        "inputs": [
          { "type": "string", "query": "#sec-cat-form-properties", "sourceAttribute": "data-sec-cat-form-state", "indexesKeys": [ "current-action" ] },
          "replace"
        ]
      }
    ],
    "actionsTrue": [
      { "type": "event", "outputTarget": "#domain-fields-container", "outputEvent": "append-domain" }
    ]
  },
  { "type": "action",
    "inputs": [
      { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": "restore-domain" },
      { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": "default-domain-buttons" }
    ]
  }
] }'>{{ page.common.cancel }}</button>
<!-- Disabled by default. (TODO) Brings up a delete confirmation dialog. If confirmed, deletes the current domain from memory, loads the previous domain in the current form, or resets the form if no previous domain exists. Also updates buttons across forms and enables/disabled buttons in the current form. -->
<button id="delete-domain" type="button" disabled="disabled" class="btn btn-default wb-calculate wb-format-gen" data-wb-calculate='{ "ignoreInit": true, "eventTrigger": "click", "eventElement": "#delete-domain", "operations": [
  { "type": "action",
    "inputs": [
      { "type": "event", "outputTarget": "#delete-domain", "outputEvent": "delete-domain-proceed" }
    ]
  }
] }' data-wb-format-gen='{ "eventTrigger": "delete-domain-proceed", "eventElement": "#delete-domain", "operations": [
  { "type": "sessionStorage", "key": "assessment", "indexesKeys": [
      { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-domain" ] }
    ], "action": "delete"
  },
  { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-domain" ], "source": { "type": "sessionStorage", "key": "assessment", "action": "closestIndex", "source": { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-domain" ] } }, "action": "replace" },
  { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": "restore-domain" },
  { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": "default-domain-buttons" }
] }'>{{ page.common.delete }}</button>
<!-- Disabled by default. Resets the current form and enables/disables buttons in the current form. -->
<button id="add-another-domain" type="button" disabled="disabled" class="btn btn-default wb-format-gen wb-calculate" data-wb-format-gen='{ "eventTrigger": "click", "eventElement": "#add-another-domain", "operations": [
  { "resetForm": "#domain-form" }
] }' data-wb-calculate='{ "ignoreInit": true, "eventTrigger": "click", "eventElement": "#add-another-domain", "operations": [
  { "type": "action",
    "inputs": [
      { "type": "outputValue", "outputTarget": "#save-domain, #delete-domain, #add-another-domain, #add-activity", "outputProperty": "disabled", "value": true },
      { "type": "outputValue", "outputTarget": "#cancel-domain", "outputProperty": "disabled", "value": false },
      { "type": "outputValue", "outputTarget": "#cancel-domain", "outputAttribute": "data-add-source", "value": "domain" },
      { "type": "event", "outputTarget": "#domain-field", "outputEvent": "setfocus.wb" }
    ]
  }
] }'>{{ page.domain[ "add-domain-button" ] }}</button>
<!-- Disabled by default. Resets the activity form, enables/disables buttons in the activity form, shows the activity form, hides this form. -->
<button id="add-activity" type="button" disabled="disabled" class="btn btn-default wb-format-gen wb-calculate" data-wb-format-gen='{ "eventTrigger": "click", "eventElement": "#add-activity", "operations": [
  { "resetForm": "#activity-form" }
] }' data-wb-calculate='{ "ignoreInit": true, "eventTrigger": "click", "eventElement": "#add-activity", "operations": [
  { "type": "action",
    "inputs": [
      { "type": "outputValue", "outputTarget": "#save-activity, #delete-activity, #add-another-activity, #add-component", "outputProperty": "disabled", "value": true },
      { "type": "outputValue", "outputTarget": "#cancel-activity", "outputProperty": "disabled", "value": false },
      { "type": "outputValue", "outputTarget": "#cancel-activity", "outputAttribute": "data-add-source", "value": "domain" },
      { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": "show-activity" }
    ]
  }
] }'>{{ page.domain[ "add-activity-button" ] }}</button>
</div>

{% include views-vues/security-securite/categorization-tool-pagination-outil-categorisation.html itemType="domain" %}

</form>
</section>

<section id="activity-section" class="hidden wb-frmvld">
<form id="activity-form" class="form-horizontal" method="post">

## {{ page.activity.title }}

{{ page.activity.intro1 }}

{{ page.activity.intro2 }}

<div id="activity-fields-container" class="wb-calculate wb-format-gen" data-wb-calculate='{ "ignoreInit": true, "eventTrigger": "input", "eventElement": "#activity-fields-container", "operations": [
  { "type": "conditional",
    "inputs": [
      { "type": "==",
        "inputs": [
          { "type": "boolean", "query": "#save-activity", "sourceProperty": "disabled" },
          true
        ]
      }
    ],
    "actionsTrue": [
      { "type": "outputValue", "outputTarget": "#save-activity, #cancel-activity", "outputProperty": "disabled", "value": false },
      { "type": "conditional",
        "inputs": [
          { "type": "==",
            "inputs": [
              { "type": "boolean", "query": "#delete-activity", "sourceProperty": "disabled" },
              false
            ]
          },
          { "type": "==",
            "inputs": [
              { "type": "string", "query": "#sec-cat-form-properties", "sourceAttribute": "data-sec-cat-form-state", "indexesKeys": [ "current-action" ] },
              "append"
            ]
          }
        ],
        "actionsTrue": [
          { "type": "event", "outputTarget": "#activity-fields-container", "outputEvent": "edit-activity" }
        ]
      },
      { "type": "outputValue", "outputTarget": "#delete-activity, #add-another-activity, #add-component", "outputProperty": "disabled", "value": true }
    ]
  }
] }' data-wb-format-gen='[
  { "eventTrigger": "edit-activity", "eventElement": "#activity-fields-container", "operations": [
    { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-action" ], "action": "replace", "data": "replace" },
    { "type": "dataAttribute", "element": "#save-activity", "key": "data-wb-format-gen", "indexesKeys": [ 0, "operations", 0, "indexesKeys", 3 ], "action": "replace", "data": { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-activity" ] } }
  ] },
  { "eventTrigger": "append-activity", "eventElement": "#activity-fields-container", "operations": [
    { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-action" ], "action": "replace", "data": "append" },
    { "type": "dataAttribute", "element": "#save-activity", "key": "data-wb-format-gen", "indexesKeys": [ 0, "operations", 0, "indexesKeys", 3 ], "action": "delete" }
  ] }
]'>

<div class="form-group" markdown="0">
<label for="activity-field" class="required {{ page.labelGridClass }}"><span class="field-name">{{ page.activity[ "activity-label" ] }}</span> <strong class="required">({{ site.required[ page.lang ] }})</strong></label>
<div class="{{ page.fieldGridClass }}">
<input name="activity-field" id="activity-field" type="text" required="required" pattern=".{2,}" data-rule-minlength="2" />
</div>
</div>

</div>

<div class="btn-group" markdown="0">
<!-- Save to memory, update buttons across forms, enables/disables buttons in the current form, and (TODO) shows an indicator that the save was successful -->
<button id="save-activity" type="submit" disabled="disabled" class="btn btn-primary wb-calculate wb-format-gen" data-wb-calculate='[
  { "ignoreInit": true, "eventTrigger": "submit", "eventElement": "#activity-form", "listenerElement": "body", "returnFalse": true, "operations": [
    { "type": "action",
      "inputs": [
        { "type": "outputValue", "outputTarget": "#cancel-activity", "outputAttribute": "data-add-source", "value": "activity" },
        { "type": "event", "outputTarget": "#save-activity", "outputEvent": "save-activity-proceed" }
      ]
    }
  ] },
  { "ignoreInit": true, "eventTrigger": "save-activity-complete", "eventElement": "#save-activity", "operations": [
      { "type": "conditional",
        "inputs": [
          { "type": "==",
            "inputs": [
              { "type": "string", "query": "#sec-cat-form-properties", "sourceAttribute": "data-sec-cat-form-state", "indexesKeys": [ "current-action" ] },
              "append"
            ]
          }
        ],
        "actionsTrue": [
          { "type": "event", "outputTarget": "#save-activity", "outputEvent": "last-activity" }
        ],
        "actionsFalse": [
          { "type": "event", "outputTarget": "#activity-fields-container", "outputEvent": "append-activity" }
        ]
      },
      { "type": "action",
        "inputs": [
          { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": "default-activity-buttons" }
        ]
      }
  ] }
]' data-wb-format-gen='[
  { "eventTrigger": "save-activity-proceed", "eventElement": "#save-activity", "operations": [
    { "type": "sessionStorage", "key": "assessment", "indexesKeys": [
        { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-domain" ] },
        0, "activities"
      ], "source": "form-state", "container": "#activity-form",
      "action": { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-action" ] }
    },
    { "type": "event", "outputTarget": "#save-activity", "outputEvent": "save-activity-complete" }
  ] },
  { "eventTrigger": "last-activity", "eventElement": "#save-activity", "operations": [
    { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-activity" ], "action": "replace", "source": { "type": "sessionStorage", "key": "assessment", "indexesKeys": [
      { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-domain" ] },
      0, "activities"
    ], "action": "lastIndex" } }
  ] }
]'>{{ page.common.save }}</button>
<!-- Loads the previous activity in the current form or clear the forms where a previous activity does not exist. Also enables/disables buttons in the current form. -->
<button id="cancel-activity" type="button" class="btn btn-default wb-calculate" data-add-source="activity" data-wb-calculate='{ "ignoreInit": true, "eventTrigger": "click", "eventElement": "#cancel-activity", "operations": [
  { "type": "conditional",
    "inputs": [
      { "type": "==",
        "inputs": [
          { "type": "string", "query": "#sec-cat-form-properties", "sourceAttribute": "data-sec-cat-form-state", "indexesKeys": [ "current-action" ] },
          "append"
        ]
      },
      { "type": "!=",
        "inputs": [
          { "type": "string", "query": "#cancel-activity", "sourceAttribute": "data-add-source" },
          "activity"
        ]
      }
    ],
    "actionsTrue": [
      { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": { "type": "concat", "inputs": [
          "restore-", { "type": "string", "query": "#cancel-activity", "sourceAttribute": "data-add-source" }
        ] }
      },
      { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": { "type": "concat", "inputs": [
          "default-", { "type": "string", "query": "#cancel-activity", "sourceAttribute": "data-add-source" }, "-buttons"
        ] }
      },
      { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": { "type": "concat", "inputs": [
          "show-", { "type": "string", "query": "#cancel-activity", "sourceAttribute": "data-add-source" }
        ] }
      }
    ],
    "actionsFalse": [
      { "type": "conditional",
        "inputs": [
          { "type": "==",
            "inputs": [
              { "type": "string", "query": "#sec-cat-form-properties", "sourceAttribute": "data-sec-cat-form-state", "indexesKeys": [ "current-action" ] },
              "replace"
            ]
          }
        ],
        "actionsTrue": [
          { "type": "event", "outputTarget": "#activity-fields-container", "outputEvent": "append-activity" }
        ]
      },
      { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": "default-activity-buttons" },
      { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": "restore-activity" }
    ]
  }
] }'>{{ page.common.cancel }}</button>
<!-- Disabled by default. (TODO) Brings up a delete confirmation dialog. If confirmed, deletes the current activity from memory, loads the previous activity in the current form, or resets the form if no previous activity exists. Also updates buttons across forms and enables/disabled buttons in the current form. -->
<button id="delete-activity" type="button" disabled="disabled" class="btn btn-default wb-calculate wb-format-gen" data-wb-calculate='{ "ignoreInit": true, "eventTrigger": "click", "eventElement": "#delete-activity", "operations": [
  { "type": "action",
    "inputs": [
      { "type": "event", "outputTarget": "#delete-activity", "outputEvent": "delete-activity-proceed" }
    ]
  }
] }' data-wb-format-gen='{ "eventTrigger": "delete-activity-proceed", "eventElement": "#delete-activity", "operations": [
  { "type": "sessionStorage", "key": "assessment", "indexesKeys": [
    { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-domain" ] },
    0, "activities",
    { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-activity" ] }
  ], "action": "delete" },
  { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-activity" ], "source": { "type": "sessionStorage", "key": "assessment", "indexesKeys":[
    { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-domain" ] },
    0, "activities"
  ], "action": "closestIndex", "source": { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-activity" ] } }, "action": "replace" },
  { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": "restore-activity" },
  { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": "default-activity-buttons" }
] }'>{{ page.common.delete }}</button>
<!-- Disabled by default. Resets the current form and enables/disables buttons in the current form. -->
<button id="add-another-activity" type="button" disabled="disabled" class="btn btn-default wb-format-gen wb-calculate" data-wb-format-gen='{ "eventTrigger": "click", "eventElement": "#add-another-activity", "operations": [
  { "resetForm": "#activity-form" }
] }' data-wb-calculate='{ "ignoreInit": true, "eventTrigger": "click", "eventElement": "#add-another-activity", "operations": [
  { "type": "action",
    "inputs": [
      { "type": "outputValue", "outputTarget": "#save-activity, #delete-activity, #add-another-activity, #add-component", "outputProperty": "disabled", "value": true },
      { "type": "outputValue", "outputTarget": "#cancel-activity", "outputProperty": "disabled", "value": false },
      { "type": "outputValue", "outputTarget": "#cancel-activity", "outputAttribute": "data-add-source", "value": "activity" },
      { "type": "event", "outputTarget": "#activity-field", "outputEvent": "setfocus.wb" }
    ]
  }
] }'>{{ page.activity[ "add-activity-button" ] }}</button>
<!-- Disabled by default. Resets the component form, enables/disables buttons in the component form, shows the component form, hides this form. -->
<button id="add-component" type="button" disabled="disabled" class="btn btn-default wb-format-gen wb-calculate" data-wb-format-gen='{ "eventTrigger": "click", "eventElement": "#add-component", "operations": [
  { "resetForm": "#component-form" }
] }' data-wb-calculate='{ "ignoreInit": true, "eventTrigger": "click", "eventElement": "#add-component", "operations": [
  { "type": "action",
    "inputs": [
      { "type": "outputValue", "outputTarget": "#save-component, #delete-component, #add-another-component, #add-confidentiality, #add-integrity, #add-availability", "outputProperty": "disabled", "value": true },
      { "type": "outputValue", "outputTarget": "#cancel-component", "outputProperty": "disabled", "value": false },
      { "type": "outputValue", "outputTarget": "#cancel-component", "outputAttribute": "data-add-source", "value": "activity" },
      { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": "show-component" }
    ]
  }
] }'>{{ page.activity[ "add-component-button" ] }}</button>
</div>

{% include views-vues/security-securite/categorization-tool-pagination-outil-categorisation.html itemType="activity" %}

</form>
</section>

<section id="component-section" class="hidden wb-frmvld">
<form id="component-form" class="form-horizontal" method="post">

## {{ page.component.title }}

<div id="component-fields-container" class="wb-calculate wb-format-gen" data-wb-calculate='{ "ignoreInit": true, "eventTrigger": "input", "eventElement": "#component-fields-container", "operations": [
  { "type": "conditional",
    "inputs": [
      { "type": "==",
        "inputs": [
          { "type": "boolean", "query": "#save-component", "sourceProperty": "disabled" },
          true
        ]
      }
    ],
    "actionsTrue": [
      { "type": "outputValue", "outputTarget": "#save-component, #cancel-component", "outputProperty": "disabled", "value": false },
      { "type": "conditional",
        "inputs": [
          { "type": "==",
            "inputs": [
              { "type": "boolean", "query": "#delete-component", "sourceProperty": "disabled" },
              false
            ]
          },
          { "type": "==",
            "inputs": [
              { "type": "string", "query": "#sec-cat-form-properties", "sourceAttribute": "data-sec-cat-form-state", "indexesKeys": [ "current-action" ] },
              "append"
            ]
          }
        ],
        "actionsTrue": [
          { "type": "event", "outputTarget": "#component-fields-container", "outputEvent": "edit-component" }
        ]
      },
      { "type": "outputValue", "outputTarget": "#delete-component, #add-another-component, #add-confidentiality, #add-integrity, #add-availability", "outputProperty": "disabled", "value": true }
    ]
  }
] }' data-wb-format-gen='[
  { "eventTrigger": "edit-component", "eventElement": "#component-fields-container", "operations": [
    { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-action" ], "action": "replace", "data": "replace" },
    { "type": "dataAttribute", "element": "#save-component", "key": "data-wb-format-gen", "indexesKeys": [ 0, "operations", 0, "indexesKeys", 6 ], "action": "replace", "data": { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-component" ] } }
  ] },
  { "eventTrigger": "append-component", "eventElement": "#component-fields-container", "operations": [
    { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-action" ], "action": "replace", "data": "append" },
    { "type": "dataAttribute", "element": "#save-component", "key": "data-wb-format-gen", "indexesKeys": [ 0, "operations", 0, "indexesKeys", 6 ], "action": "delete" }
  ] }
]'>

<div class="form-group" markdown="0">
<label for="component-field" class="required {{ page.labelGridClass }}"><span class="field-name">{{ page.component[ "component-label" ] }}</span> <strong class="required">({{ site.required[ page.lang ] }})</strong></label>
<div class="{{ page.fieldGridClass }}">
<input name="component-field" id="component-field" type="text" required="required" pattern=".{2,}" data-rule-minlength="2" />
</div>
</div>

<div class="form-group" markdown="0">
<label for="component-description" class="required {{ page.labelGridClass }}"><span class="field-name">{{ page.component[ "component-description-label" ] }}</span> <strong class="required">({{ site.required[ page.lang ] }})</strong></label>
<div class="{{ page.fieldGridClass }}">
<textarea name="component-description" id="component-description" required="required"></textarea>
</div>
</div>

<div class="form-group" markdown="0">
<label for="component-type" class="required {{ page.labelGridClass }}"><span class="field-name">{{ page.component[ "component-type-label" ] }}</span> <strong class="required">({{ site.required[ page.lang ] }})</strong></label>
<div class="{{ page.fieldGridClass }}">
<select class="form-control" id="component-type" name="component-type" required="required">
<option label="{{ page.component[ "component-type-sub-label" ] }}"></option>
<option value="1">{{ page.component[ "component-type-option-1" ] }}</option>
<option value="2">{{ page.component[ "component-type-option-2" ] }}</option>
</select>
</div>
</div>

<div class="form-group" markdown="0">
<label for="authoritative-source" class="required {{ page.labelGridClass }}"><span class="field-name">{{ page.component[ "authoritative-source-label" ] }}</span> <strong class="required">({{ site.required[ page.lang ] }})</strong></label>
<div class="{{ page.fieldGridClass }}">
<textarea name="authoritative-source" id="authoritative-source" required="required"></textarea>
</div>
</div>

</div>

<div class="btn-group" markdown="0">
<!-- Save to memory, update buttons across forms, enables/disables buttons in the current form, and (TODO) shows an indicator that the save was successful -->
<button id="save-component" type="submit" class="btn btn-primary wb-calculate wb-format-gen" data-wb-calculate='[
  { "ignoreInit": true, "eventTrigger": "submit", "eventElement": "#component-form", "listenerElement": "body", "returnFalse": true, "operations": [
    { "type": "action",
      "inputs": [
        { "type": "outputValue", "outputTarget": "#cancel-component", "outputAttribute": "data-add-source", "value": "component" },
        { "type": "event", "outputTarget": "#save-component", "outputEvent": "save-component-proceed" }
      ]
    }
  ] },
  { "ignoreInit": true, "eventTrigger": "save-component-complete", "eventElement": "#save-component", "operations": [
      { "type": "conditional",
        "inputs": [
          { "type": "==",
            "inputs": [
              { "type": "string", "query": "#sec-cat-form-properties", "sourceAttribute": "data-sec-cat-form-state", "indexesKeys": [ "current-action" ] },
              "append"
            ]
          }
        ],
        "actionsTrue": [
          { "type": "event", "outputTarget": "#save-component", "outputEvent": "last-component" }
        ],
        "actionsFalse": [
          { "type": "event", "outputTarget": "#component-fields-container", "outputEvent": "append-component" }
        ]
      },
      {
        "type": "action",
        "inputs": [
          { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": "default-component-buttons" }
        ]
      }
  ] }
]' data-wb-format-gen='[
  { "eventTrigger": "save-component-proceed", "eventElement": "#save-component", "operations": [
    { "type": "sessionStorage", "key": "assessment", "indexesKeys": [
        { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-domain" ] },
        0, "activities",
        { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-activity" ] },
        0, "components"
      ], "source": "form-state", "container": "#component-form",
      "action": { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-action" ] }
    },
    { "type": "event", "outputTarget": "#save-component", "outputEvent": "save-component-complete" }
  ] },
  { "eventTrigger": "last-component", "eventElement": "#save-component", "operations": [
    { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-component" ], "action": "replace", "source": { "type": "sessionStorage", "key": "assessment", "indexesKeys": [
      { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-domain" ] },
      0, "activities",
      { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-activity" ] },
      0, "components"
    ], "action": "lastIndex" } }
  ] }
]'>{{ page.common.save }}</button>
<!-- Loads the previous component in the current form or clear the forms where a previous component does not exist. Also enables/disables buttons in the current form. -->
<button id="cancel-component" type="button" class="btn btn-default wb-calculate" data-add-source="component" data-wb-calculate='{ "ignoreInit": true, "eventTrigger": "click", "eventElement": "#cancel-component", "operations": [
  { "type": "conditional",
    "inputs": [
      { "type": "==",
        "inputs": [
          { "type": "string", "query": "#sec-cat-form-properties", "sourceAttribute": "data-sec-cat-form-state", "indexesKeys": [ "current-action" ] },
          "append"
        ]
      },
      { "type": "!=",
        "inputs": [
          { "type": "string", "query": "#cancel-component", "sourceAttribute": "data-add-source" },
          "component"
        ]
      }
    ],
    "actionsTrue": [
      { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": { "type": "concat", "inputs": [
          "restore-", { "type": "string", "query": "#cancel-component", "sourceAttribute": "data-add-source" }
        ] }
      },
      { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": { "type": "concat", "inputs": [
          "default-", { "type": "string", "query": "#cancel-component", "sourceAttribute": "data-add-source" }, "-buttons"
        ] }
      },
      { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": { "type": "concat", "inputs": [
          "show-", { "type": "string", "query": "#cancel-component", "sourceAttribute": "data-add-source" }
        ] }
      }
    ],
    "actionsFalse": [
      { "type": "conditional",
        "inputs": [
          { "type": "==",
            "inputs": [
              { "type": "string", "query": "#sec-cat-form-properties", "sourceAttribute": "data-sec-cat-form-state", "indexesKeys": [ "current-action" ] },
              "replace"
            ]
          }
        ],
        "actionsTrue": [
          { "type": "event", "outputTarget": "#component-fields-container", "outputEvent": "append-component" }
        ]
      },
      { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": "default-component-buttons" },
      { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": "restore-component" }
    ]
  }
] }'>{{ page.common.cancel }}</button>
<!-- Disabled by default. (TODO) Brings up a delete confirmation dialog. If confirmed, deletes the current component from memory, loads the previous component in the current form, or resets the form if no previous component exists. Also updates buttons across forms and enables/disabled buttons in the current form. -->
<button id="delete-component" type="button" disabled="disabled" class="btn btn-default wb-calculate wb-format-gen" data-wb-calculate='{ "ignoreInit": true, "eventTrigger": "click", "eventElement": "#delete-component", "operations": [
  { "type": "action",
    "inputs": [
      { "type": "event", "outputTarget": "#delete-component", "outputEvent": "delete-component-proceed" }
    ]
  }
] }' data-wb-format-gen='{ "eventTrigger": "delete-component-proceed", "eventElement": "#delete-component", "operations": [
  { "type": "sessionStorage", "key": "assessment", "indexesKeys": [
    { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-domain" ] },
    0, "activities",
    { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-activity" ] },
    0, "components",
    { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-component" ] }
  ], "action": "delete" },
  { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-component" ], "source": { "type": "sessionStorage", "key": "assessment", "indexesKeys":[
    { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-domain" ] },
    0, "activities",
    { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-activity" ] },
    0, "components"
  ], "action": "closestIndex", "source": { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-component" ] } }, "action": "replace" },
  { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": "restore-component" },
  { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": "default-component-buttons" }
] }'>{{ page.common.delete }}</button>
<!-- Disabled by default. Resets the current form and enables/disables buttons in the current form. -->
<button id="add-another-component" type="button" disabled="disabled" class="btn btn-default wb-format-gen wb-calculate" data-wb-format-gen='{ "eventTrigger": "click", "eventElement": "#add-another-component", "operations": [
  { "resetForm": "#component-form" }
] }' data-wb-calculate='{ "ignoreInit": true, "eventTrigger": "click", "eventElement": "#add-another-component", "operations": [
  { "type": "action",
    "inputs": [
      { "type": "outputValue", "outputTarget": "#save-component, #delete-component, #add-another-component, #add-confidentiality, #add-integrity, #add-availability", "outputProperty": "disabled", "value": true },
      { "type": "outputValue", "outputTarget": "#cancel-component", "outputProperty": "disabled", "value": false },
      { "type": "outputValue", "outputTarget": "#cancel-component", "outputAttribute": "data-add-source", "value": "component" },
      { "type": "event", "outputTarget": "#component-field", "outputEvent": "setfocus.wb" }
    ]
  }
] }'>{{ page.component[ "add-component-button" ] }}</button>{%
for lossType in page.lossTypes %}{%
  assign addButton = "add-" | append: lossType | append: "-button" %}
<!-- Disabled by default. Resets the loss of {{ lossType }} form, enables/disables buttons in the loss of {{ lossType }} form, shows the loss of {{ lossType }} form, hides this form. -->
<button id="add-{{ lossType }}" type="button" disabled="disabled" class="btn btn-default wb-format-gen wb-calculate" data-wb-format-gen='{ "eventTrigger": "click", "eventElement": "#add-{{ lossType }}", "operations": [
  { "resetForm": "#{{ lossType }}-form" }
] }' data-wb-calculate='{ "ignoreInit": true, "eventTrigger": "click", "eventElement": "#add-{{ lossType }}", "operations": [
  { "type": "action",
    "inputs": [
      { "type": "outputValue", "outputTarget": "#save-{{ lossType }}, #delete-{{ lossType }}, #add-another-{{ lossType }}{% if lossType != "confidentiality" %}, #add-confidentiality-{{ lossType }}-form{% endif %}{% if lossType != "integrity" %}, #add-integrity-{{ lossType }}-form{% endif %}{% if lossType != "availability" %}, #add-availability-{{ lossType }}-form{% endif %}", "outputProperty": "disabled", "value": true },
      { "type": "outputValue", "outputTarget": "#cancel-{{ lossType }}", "outputProperty": "disabled", "value": false },
      { "type": "outputValue", "outputTarget": "#cancel-{{ lossType }}", "outputAttribute": "data-add-source", "value": "component" },
      { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": "show-{{ lossType }}" }
    ]
  }
] }'>{{ page[ lossType ][ addButton ] }}</button>{%
endfor %}
</div>

{% include views-vues/security-securite/categorization-tool-pagination-outil-categorisation.html itemType="component" %}

</form>
</section>

{% assign lossTypeIndex = 0 %}{%
for lossType in page.lossTypes %}{%
  assign previousLossTypeIndex = lossTypeIndex | minus: 1 %}
<section id="{{ lossType }}-section" class="hidden wb-frmvld">
<form id="{{ lossType }}-form" class="form-horizontal" method="post">

## {{ page[ lossType ].title }}

{{ page[ lossType ].intro }}

<div id="{{ lossType }}-fields-container" class="wb-calculate wb-format-gen" data-wb-calculate='{ "ignoreInit": true, "eventTrigger": "input", "eventElement": "#{{ lossType }}-fields-container", "operations": [
  { "type": "conditional",
    "inputs": [
      { "type": "==",
        "inputs": [
          { "type": "boolean", "query": "#save-{{ lossType }}", "sourceProperty": "disabled" },
          true
        ]
      }
    ],
    "actionsTrue": [
      { "type": "outputValue", "outputTarget": "#save-{{ lossType }}, #cancel-{{ lossType }}", "outputProperty": "disabled", "value": false },
      { "type": "conditional",
        "inputs": [
          { "type": "==",
            "inputs": [
              { "type": "boolean", "query": "#delete-{{ lossType }}", "sourceProperty": "disabled" },
              false
            ]
          },
          { "type": "==",
            "inputs": [
              { "type": "string", "query": "#sec-cat-form-properties", "sourceAttribute": "data-sec-cat-form-state", "indexesKeys": [ "current-action" ] },
              "append"
            ]
          }
        ],
        "actionsTrue": [
          { "type": "event", "outputTarget": "#{{ lossType }}-fields-container", "outputEvent": "edit-{{ lossType }}" }
        ]
      },
      { "type": "outputValue", "outputTarget": "#delete-{{ lossType }}, #add{% if lossTypeIndex == 0 %}-another{% endif %}-confidentiality{% if lossTypeIndex != 0 %}-{{ lossType }}-form{% endif %}, #add{% if lossTypeIndex == 1 %}-another{% endif %}-integrity{% if lossTypeIndex != 1 %}-{{ lossType }}-form{% endif %}, #add{% if lossTypeIndex == 2 %}-another{% endif %}-availability{% if lossTypeIndex != 2 %}-{{ lossType }}-form{% endif %}", "outputProperty": "disabled", "value": true }
    ]
  }
] }' data-wb-format-gen='[
  { "eventTrigger": "edit-{{ lossType }}", "eventElement": "#{{ lossType }}-fields-container", "operations": [
    { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-action" ], "action": "replace", "data": "replace" },
    { "type": "dataAttribute", "element": "#save-{{ lossType }}", "key": "data-wb-format-gen", "indexesKeys": [ 0, "operations", 0, "indexesKeys", 9 ], "action": "replace", "data": { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-{{ lossType }}" ] } }
  ] },
  { "eventTrigger": "append-{{ lossType }}", "eventElement": "#{{ lossType }}-fields-container", "operations": [
    { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-action" ], "action": "replace", "data": "append" },
    { "type": "dataAttribute", "element": "#save-{{ lossType }}", "key": "data-wb-format-gen", "indexesKeys": [ 0, "operations", 0, "indexesKeys", 9 ], "action": "delete" }
  ] }
]'>

<div class="form-group" markdown="0">
<label for="failure-scenario-{{ lossType }}" class="required {{ page.labelGridClass }}"><span class="field-name">{{ page.lossOfCommon[ "failure-scenario-label" ] }}</span> <strong class="required">({{ site.required[ page.lang ] }})</strong></label>
<div class="{{ page.fieldGridClass }}">
<input name="failure-scenario-{{ lossType }}" id="failure-scenario-{{ lossType }}" type="text" required="required" pattern=".{2,}" data-rule-minlength="2" />
</div>
</div>

<div class="form-group" markdown="0">
<label for="type-of-injury-{{ lossType }}" class="required {{ page.labelGridClass }}"><span class="field-name">{{ page[ lossType ][ "type-of-injury-label" ] }}</span> <strong class="required">({{ site.required[ page.lang ] }})</strong></label>
<div class="{{ page.fieldGridClass }}">
<select class="form-control" id="type-of-injury-{{ lossType }}" name="type-of-injury-{{ lossType }}" required="required">
<option label="{{ page.lossOfCommon[ "failure-scenario-sub-label" ] }}"></option>
<option value="1">{{ page.lossOfCommon[ "failure-scenario-option-1" ] }}</option>
<option value="2">{{ page.lossOfCommon[ "failure-scenario-option-2" ] }}</option>
<option value="3">{{ page.lossOfCommon[ "failure-scenario-option-3" ] }}</option>
<option value="4">{{ page.lossOfCommon[ "failure-scenario-option-4" ] }}</option>
<option value="5">{{ page.lossOfCommon[ "failure-scenario-option-5" ] }}</option>
<option value="6">{{ page.lossOfCommon[ "failure-scenario-option-6" ] }}</option>
<option value="7">{{ page.lossOfCommon[ "failure-scenario-option-7" ] }}</option>
<option value="8">{{ page.lossOfCommon[ "failure-scenario-option-8" ] }}</option>
<option value="9">{{ page.lossOfCommon[ "failure-scenario-option-9" ] }}</option>
<option value="0">{{ page.lossOfCommon[ "failure-scenario-option-0" ] }}</option>
</select>
</div>
</div>

<div class="form-group" markdown="0">
<label for="injury-significance-{{ lossType }}" class="required {{ page.labelGridClass }}"><span class="field-name">{{ page.lossOfCommon[ "injury-significance" ] }}</span> <strong class="required">({{ site.required[ page.lang ] }})</strong></label>
<div class="{{ page.fieldGridClass }}">
<select class="form-control" id="injury-significance-{{ lossType }}" name="injury-significance-{{ lossType }}" required="required">
<option label="{{ page.lossOfCommon[ "injury-significance-sub-label" ] }}"></option>
<option value="1">{{ page.lossOfCommon[ "injury-significance-option-1" ] }}</option>
<option value="2">{{ page.lossOfCommon[ "injury-significance-option-2" ] }}</option>
<option value="3">{{ page.lossOfCommon[ "injury-significance-option-3" ] }}</option>
<option value="4">{{ page.lossOfCommon[ "injury-significance-option-4" ] }}</option>
<option value="5">{{ page.lossOfCommon[ "injury-significance-option-5" ] }}</option>
<option value="0">{{ page.lossOfCommon[ "injury-significance-option-0" ] }}</option>
</select>
</div>
</div>

**{{ page[ lossType ].example1 }}** {{ page[ lossType ].example2 }}

<div class="form-group" markdown="0">
<label for="analysis-{{ lossType }}" class="required {{ page.labelGridClass }}"><span class="field-name">{{ page.lossOfCommon[ "analysis-label" ] }}</span> <strong class="required">({{ site.required[ page.lang ] }})</strong></label>
<div class="{{ page.fieldGridClass }}">
<textarea name="analysis-{{ lossType }}" id="analysis-{{ lossType }}" required="required"></textarea>
</div>
</div>

</div>

<div class="btn-group" markdown="0">
<!-- Save to memory, update buttons across forms, enables/disables buttons in the current form, and (TODO) shows an indicator that the save was successful -->
<button id="save-{{ lossType }}" type="submit" disabled="disabled" class="btn btn-primary wb-format-gen wb-calculate" data-wb-calculate='[
  { "ignoreInit": true, "eventTrigger": "submit", "eventElement": "#{{ lossType }}-form", "listenerElement": "body", "returnFalse": true, "operations": [
      { "type": "action",
        "inputs": [
          { "type": "outputValue", "outputTarget": "#cancel-{{ lossType }}", "outputAttribute": "data-add-source", "value": "{{ lossType }}" },
          { "type": "event", "outputTarget": "#save-{{ lossType }}", "outputEvent": "save-{{ lossType }}-proceed" }
        ]
      }
    ]
  },
  { "ignoreInit": true, "eventTrigger": "save-{{ lossType }}-complete", "eventElement": "#save-{{ lossType }}", "operations": [
      { "type": "conditional",
        "inputs": [
          { "type": "==",
            "inputs": [
              { "type": "string", "query": "#sec-cat-form-properties", "sourceAttribute": "data-sec-cat-form-state", "indexesKeys": [ "current-action" ] },
              "append"
            ]
          }
        ],
        "actionsTrue": [
          { "type": "event", "outputTarget": "#save-{{ lossType }}", "outputEvent": "last-{{ lossType }}" }
        ],
        "actionsFalse": [
          { "type": "event", "outputTarget": "#{{ lossType }}-fields-container", "outputEvent": "append-{{ lossType }}" }
        ]
      },
      {
        "type": "action",
        "inputs": [
          { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": "default-{{ lossType }}-buttons" }
        ]
      }
  ] }
]' data-wb-format-gen='[
  { "eventTrigger": "save-{{ lossType }}-proceed", "eventElement": "#save-{{ lossType }}", "operations": [
    { "type": "sessionStorage", "key": "assessment", "indexesKeys": [
      { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-domain" ] },
      0, "activities",
      { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-activity" ] },
      0, "components",
      { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-component" ] },
      0, "{{ lossType }}"
    ], "source": "form-state", "container": "#{{ lossType }}-form",
    "action": { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-action" ] }
    },
    { "type": "event", "outputTarget": "#save-{{ lossType }}", "outputEvent": "save-{{ lossType }}-complete" }
  ] },
  { "eventTrigger": "last-{{ lossType }}", "eventElement": "#save-{{ lossType }}", "operations": [
    { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-{{ lossType }}" ], "action": "replace", "source": { "type": "sessionStorage", "key": "assessment", "indexesKeys": [
      { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-domain" ] },
      0, "activities",
      { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-activity" ] },
      0, "components",
      { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-component" ] },
      0, "{{ lossType }}"
    ], "action": "lastIndex" } }
  ] }
]'>{{ page.common.save }}</button>
<!-- Loads the previous loss of {{ lossType }} in the current form or clear the forms where a previous loss of {{ lossType }} does not exist. Also enables/disables buttons in the current form. -->
<button id="cancel-{{ lossType }}" type="button" disabled="disabled" class="btn btn-default wb-calculate" data-add-source="{{ lossType }}" data-wb-calculate='{ "ignoreInit": true, "eventTrigger": "click", "eventElement": "#cancel-{{ lossType }}", "operations": [
  { "type": "conditional",
    "inputs": [
      { "type": "==",
        "inputs": [
          { "type": "string", "query": "#sec-cat-form-properties", "sourceAttribute": "data-sec-cat-form-state", "indexesKeys": [ "current-action" ] },
          "append"
        ]
      },
      { "type": "!=",
        "inputs": [
          { "type": "string", "query": "#cancel-{{ lossType }}", "sourceAttribute": "data-add-source" },
          "{{ lossType }}"
        ]
      }
    ],
    "actionsTrue": [
      { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": { "type": "concat", "inputs": [
          "restore-", { "type": "string", "query": "#cancel-{{ lossType }}", "sourceAttribute": "data-add-source" }
        ] }
      },
      { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": { "type": "concat", "inputs": [
          "default-", { "type": "string", "query": "#cancel-{{ lossType }}", "sourceAttribute": "data-add-source" }, "-buttons"
        ] }
      },
      { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": { "type": "concat", "inputs": [
          "show-", { "type": "string", "query": "#cancel-{{ lossType }}", "sourceAttribute": "data-add-source" }
        ] }
      }
    ],
    "actionsFalse": [
      { "type": "conditional",
        "inputs": [
          { "type": "==",
            "inputs": [
              { "type": "string", "query": "#sec-cat-form-properties", "sourceAttribute": "data-sec-cat-form-state", "indexesKeys": [ "current-action" ] },
              "replace"
            ]
          }
        ],
        "actionsTrue": [
          { "type": "event", "outputTarget": "#{{ lossType }}-fields-container", "outputEvent": "append-{{ lossType }}" }
        ]
      },
      { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": "default-{{ lossType }}-buttons" },
      { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": "restore-{{ lossType }}" }
    ]
  }
] }'>{{ page.common.cancel }}</button>
<!-- Disabled by default. (TODO) Brings up a delete confirmation dialog. If confirmed, deletes the current loss of {{ lossType }} from memory, loads the previous loss of {{ lossType }} in the current form, or resets the form if no previous loss of {{ lossType }} exists. Also updates buttons across forms and enables/disabled buttons in the current form. -->
<button id="delete-{{ lossType }}" type="button" disabled="disabled" class="btn btn-default wb-calculate wb-format-gen" data-wb-calculate='{ "ignoreInit": true, "eventTrigger": "click", "eventElement": "#delete-{{ lossType }}", "operations": [
  { "type": "action",
    "inputs": [
      { "type": "event", "outputTarget": "#delete-{{ lossType }}", "outputEvent": "delete-{{ lossType }}-proceed" }
    ]
  }
] }' data-wb-format-gen='{ "eventTrigger": "delete-{{ lossType }}-proceed", "eventElement": "#delete-{{ lossType }}", "operations": [
  { "type": "sessionStorage", "key": "assessment", "indexesKeys": [
    { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-domain" ] },
    0, "activities",
    { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-activity" ] },
    0, "components",
    { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-component" ] },
    0, "{{ lossType }}",
    { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-{{ lossType }}" ] }
  ], "action": "delete" },
  { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-{{ lossType }}" ], "source": { "type": "sessionStorage", "key": "assessment", "indexesKeys":[
    { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-domain" ] },
    0, "activities",
    { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-activity" ] },
    0, "components",
    { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-component" ] },
    0, "{{ lossType }}"
  ], "action": "closestIndex", "source": { "type": "dataAttribute", "element": "#sec-cat-form-properties", "key": "data-sec-cat-form-state", "indexesKeys": [ "current-{{ lossType }}" ] } }, "action": "replace" },
  { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": "restore-{{ lossType }}" },
  { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": "default-{{ lossType }}-buttons" }
] }'>{{ page.common.delete }}</button>{%
assign lossTypeIndexInner = 0 %}{%
for lossTypeInner in page.lossTypes %}{%
  if lossTypeIndexInner == lossTypeIndex %}{%
    assign lossButton = "add-another-" | append: lossTypeInner | append: "-button" %}
<!-- Disabled by default. Resets the current form and enables/disables buttons in the current form. -->
<button id="add-another-{{ lossTypeInner }}" type="button" disabled="disabled" class="btn btn-default wb-format-gen wb-calculate" data-wb-format-gen='{ "eventTrigger": "click", "eventElement": "#add-another-{{ lossTypeInner }}", "operations": [
  { "resetForm": "#{{ lossTypeInner }}-form" }
] }' data-wb-calculate='{ "ignoreInit": true, "eventTrigger": "click", "eventElement": "#add-another-{{ lossTypeInner }}", "operations": [
  { "type": "action",
    "inputs": [
      { "type": "outputValue", "outputTarget": "#save-{{ lossTypeInner }}, #delete-{{ lossTypeInner }}, #add{% if lossTypeIndex == 0 %}-another{% endif %}-confidentiality{% if lossTypeIndex != 0 %}-{{ lossType }}-form{% endif %}, #add{% if lossTypeIndex == 1 %}-another{% endif %}-integrity{% if lossTypeIndex != 1 %}-{{ lossType }}-form{% endif %}, #add{% if lossTypeIndex == 2 %}-another{% endif %}-availability{% if lossTypeIndex != 2 %}-{{ lossType }}-form{% endif %}", "outputProperty": "disabled", "value": true },
      { "type": "outputValue", "outputTarget": "#cancel-{{ lossTypeInner }}", "outputProperty": "disabled", "value": false },
      { "type": "outputValue", "outputTarget": "#cancel-{{ lossTypeInner }}", "outputAttribute": "data-add-source", "value": "{{ lossType }}" },
      { "type": "event", "outputTarget": "#failure-scenario-{{ lossTypeInner }}", "outputEvent": "setfocus.wb" }
    ]
  }
] }'>{{ page[ lossTypeInner ][ lossButton ] }}</button>{%
  else %}{%
    assign lossButton = "add-" | append: lossTypeInner | append: "-button" %}
<!-- Disabled by default. Resets the loss of {{ lossTypeInner }} form, enables/disables buttons in the loss of {{ lossTypeInner }} form, shows the loss of {{ lossTypeInner }} form, hides this form. -->
<button id="add-{{ lossTypeInner }}-{{ lossType }}-form" type="button" disabled="disabled" class="btn btn-default wb-format-gen wb-calculate" data-wb-format-gen='{ "eventTrigger": "click", "eventElement": "#add-{{ lossTypeInner }}-{{ lossType }}-form", "operations": [
  { "resetForm": "#{{ lossTypeInner }}-form" }
] }' data-wb-calculate='{ "ignoreInit": true, "eventTrigger": "click", "eventElement": "#add-{{ lossTypeInner }}-{{ lossType }}-form", "operations": [
  { "type": "action",
    "inputs": [
      { "type": "outputValue", "outputTarget": "#save-{{ lossTypeInner }}, #delete-{{ lossTypeInner }}, #add{% if lossTypeIndex == 0 %}-another{% endif %}-confidentiality{% if lossTypeIndex != 0 %}-{{ lossType }}-form{% endif %}, #add{% if lossTypeIndex == 1 %}-another{% endif %}-integrity{% if lossTypeIndex != 1 %}-{{ lossType }}-form{% endif %}, #add{% if lossTypeIndex == 2 %}-another{% endif %}-availability{% if lossTypeIndex != 2 %}-{{ lossType }}-form{% endif %}", "outputProperty": "disabled", "value": true },
      { "type": "outputValue", "outputTarget": "#cancel-{{ lossTypeInner }}", "outputProperty": "disabled", "value": false },
      { "type": "outputValue", "outputTarget": "#cancel-{{ lossTypeInner }}", "outputAttribute": "data-add-source", "value": "{{ lossType }}" },
      { "type": "event", "outputTarget": "#sec-cat-form-properties", "outputEvent": "show-{{ lossTypeInner }}" }
    ]
  }
] }'>{{ page[ lossTypeInner ][ lossButton ] }}</button>{%
  endif %}{%
  assign lossTypeIndexInner = lossTypeIndexInner | plus: 1 %}{%
endfor %}
</div>

{% include views-vues/security-securite/categorization-tool-pagination-outil-categorisation.html itemType=lossType %}

</form>
</section>{%
  assign lossTypeIndex = lossTypeIndex | plus: 1 %}{%
endfor %}
